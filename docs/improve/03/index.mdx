---
title: 数据类型转换
---

# 03 数据类型转换

> 在`js`中，类型转换只有三种情况
>
> 1. 转换为`Boolean`类型
> 2. 转换为`Number`类型
> 3. 转换为`String`类型

## 转换为 Boolean

> 在条件判断时，除了`undefined`、`null`、`''`、`false`、`0`、`+0`、`-0`、`NaN`，其他都会转换为`true`。包括所有对象也转换为`true`

```js
// 转换为 fasle
Boolean(undefined); // false
Boolean(null); // false
Boolean(""); // false
Boolean(false); // false
Boolean(0); // false
Boolean(+0); // false
Boolean(-0); // false
Boolean(NaN); // false

// 转换为 true
Boolean({}); // true
Boolean([]); // true
Boolean(function () {}); // true
Boolean(Symbol()); // true
Boolean(BigInt(123)); // true
```

### 对象转原始类型

> 对象在转换类型的时候，会调用内置的`[[ToPrimitive]]`函数，对于该函数来说，算法逻辑一般来说如下：

- 如果已经是原始类型了，那就不需要转换了，直接返回
- 调用 `x.valueOf()`，如果转换为基础类型，就返回转换的值
- 调用 `x.toString()`，如果转换为基础类型，就返回转换的值
- 如果都没有返回基础类型，就报错

> 当然你也可以重写`Symbol.toPrimitive`方法，该方法在转原始类型时调用优先级最高

```js
let a = {
  valueOf() {
    return 0;
  },
  toString() {
    return "1";
  },
  [Symbol.toPrimitive]() {
    return 2;
  },
};

// 案例
1 + a; // 3
```

## 四则运算符

> 转换规则
>
> - 运算符其中的一边为字符串，那么就会把另外一边也转换为字符串
> - 如果一边不是字符串或者数字，那么就会把它转换为字符串或者数字

```js
1 + "1"; // "1" 数字 1  转换为字符串 "1"
true + true; // 2
4 + [1, 2, 3]; // "41,2,3" 数组通过 toString 转换为字符串，然后进行字符串拼接
```

```js title="特殊的用法"
"a" + +"b"; // aNaN
// + "b" 转换为 NaN 然后进行字符串拼接
// 在他人的代码中，你可能也会在一些代码中看到过 +'1' 的形式来快速获取 number 类型。

// 那么对于除了加法的运算符号来说，只要其中一方是数字，那么另一方就会被转换为数字
"1" - "1"; // 0
"1" * "2"; // 2
"2" / "1"; // 2

4 * "3"; // 12
4 * []; // 0
4 * [1, 2, 3]; // NaN
```

## 比较运算符

- 如果是对象，就通过`toPrimitive`转换对象
- 如果是字符串，就通过`unicode`字符索引来比较

```js
let a = {
  valueOf() {
    return 0;
  },
  toString() {
    return "1";
  },
};

// 案例
a > -1; // true
// 在以上代码中，因为 a 是对象，所以会通过 valueOf 转换为原始类型再比较值
```
